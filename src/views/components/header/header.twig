{#
| المتغيرات        | النوع    | الوصف                           |
|------------------|---------|---------------------------------|
| cart             | كائن    |                                 |
| cart.items_count | عدد صحيح |                                 |
| cart.total       | سلسلة   | المجموع المنسق مثل: "١٠٠ ر.س"   |
#}
{% set important_links = theme.settings.get('important_links') %}
{% set is_sidebar_open = false %}

<header class="store-header">
  {# شريط التنقل العلوي #}
  <div class="top-navbar bg-gray-800 text-white shadow-lg">
    <div class="container flex justify-between items-center py-2">
      {# زر القائمة #}
      <button 
        class="hamburger-menu"
        aria-label="القائمة"
        aria-expanded="false"
        aria-controls="sidebar-content">
        <span></span>
      </button>
      
      {# زر البحث #}
      <div class="header-search ml-4">
        <salla-search inline oval height="36" aria-label="بحث في المتجر"></salla-search>
      </div>
      
      {# الشعار في المنتصف - محسن #}
      <div class="flex-1 flex justify-center">
        <a class="navbar-brand" href="{{ store.url }}" aria-label="{{ store.name }}">
          <img 
            width="150"
            height="50"
            loading="eager"
            decoding="async"
            src="{{ store.logo }}"
            alt="{{ store.name }}"
            class="logo-image"
            srcset="{{ store.logo }} 1x, {{ store.logo_retina }} 2x"
          >
          <span class="sr-only">{{ store.name }}</span>
        </a>
      </div>

      {# الأزرار في اليمين - معاد هيكلتها #}
      <div class="header-actions flex items-center gap-4">
        {% if store.settings.is_multilingual or store.settings.currencies_enabled %}
          <button 
            type="button" 
            onclick="salla.event.dispatch('localization::open')" 
            class="btn--rounded-gray text-white flex items-center"
            aria-label="تغيير اللغة والعملة">
            <span class="flag iti__flag iti__{{ user.language.country_code }} rounded-sm"></span>
            <span class="mx-1.5" aria-hidden="true">|</span>
            <span>{{ currency.symbol }}</span>
          </button>
          <salla-localization-modal></salla-localization-modal>
        {% endif %}
        
        {# قائمة المستخدم - محسنة #}
        {% if user.type == 'user' %}
          <salla-user-menu 
            avatar-only 
            show-header
            aria-label="قائمة المستخدم">
          </salla-user-menu>
        {% else %}
          <button 
            class="header-btn text-white flex items-center" 
            aria-label="تسجيل الدخول"
            onclick="salla.event.dispatch('login::open')">
            <i class="header-btn__icon sicon-user-circle text-2xl" aria-hidden="true"></i>
          </button>
        {% endif %}

        {# سلة التسوق - محسنة #}
        <salla-cart-summary 
          class="flex items-center"
          aria-label="سلة التسوق">
          <i slot="icon" 
             class="header-btn__icon icon sicon-shopping-bag text-white text-2xl"
             aria-hidden="true">
          </i>
        </salla-cart-summary>
      </div>
    </div>
  </div>

  {# القائمة الجانبية #}
  <nav id="mainnav" class="main-nav-sidebar" aria-label="القائمة الرئيسية">
    <div id="sidebar-content" class="sidebar-content">
      <div class="sidebar-header">
        <h2>القائمة الرئيسية</h2>
      </div>
      <custom-main-menu 
        id="mainMenu"
        class="sidebar-nav vertical-menu"
        mobile="true"
        show-categories="true"
        show-brands="true">
      </custom-main-menu>
    </div>
  </nav>
</header>

{% if store.scope %}
  <salla-scopes 
    selection="{{ store.scope.display_as == 'popup' ? 'mandatory' : 'optional' }}"
    aria-label="اختيار النطاق">
  </salla-scopes>
{% endif %}
