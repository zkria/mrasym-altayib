// المنتج في قائمة المفضلة
.product-entry {
  @apply h-full transition-shadow duration-300 bg-white hover:shadow-default rounded-lg justify-between flex relative;

  &--wishlist {
    @apply justify-between p-4 flex-col sm:flex-row;

    .product-entry__image {
      @apply overflow-hidden w-16 h-12 md:w-20 md:h-16 rounded-md;
    }

    salla-button {
      @apply flex;
    }
  }
}

// التعليقات
.s-comments {
  &-page {
    @apply pt-16;
  }

  &-product {
    @apply bg-gray-100 mb-4 md:mb-14 py-4 md:py-14;

    .s-comments-container {
      @apply container;
    }
  }
}

// قائمة المشاركة
.share-btns-list {
  @apply absolute z-10 overflow-hidden opacity-0 top-12 bg-white flex items-center flex-col shadow-huge rounded-3xl;

  a {
    @apply block p-3 hover:text-primary;
  }
}

// خيارات المنتج
.product-options {
  .option-wrapper {
    @apply mb-4;

    select {
      @apply rounded-lg border border-gray-200 
             px-4 py-2.5 w-full
             focus:ring-primary focus:border-primary;
    }

    .color-option {
      input[type="radio"] {
        @apply hidden;

        &:checked + span {
          @apply ring-2 ring-primary ring-offset-2;
        }
      }

      span {
        @apply block cursor-pointer transition-all duration-200;
      }
    }
  }
}

// وصف المنتج
.product__description {
  ul, li {
    list-style: inherit !important;
  }

  ul, ol {
    @apply px-6;
  }

  ol {
    list-style: auto !important;
  }

  a {
    @apply text-blue-700;
  }
}

// تكبير الصور
.magnify-wrapper {
  .img-magnifier-glass {
    @apply hidden sm:block;
    position: absolute;
    z-index: 3;
    border-radius: 50%;
    cursor: none;
    width: 300px;
    height: 300px;
    opacity: 0;
    pointer-events: none;
    transform: scale(0);
    transition: transform .5s ease;
    box-shadow: inset 0px 0px 30px #949494;
  }

  &:hover {
    .img-magnifier-glass {
      opacity: 1;
      pointer-events: initial;
      transform: scale(1);
      transition-delay: 0.3s;
    }
  }
}

// شريط الشراء الثابت
@media (max-width: 640px) {
  .is-sticky-product-bar {
    &.product-single {
      @apply pb-28;
    }

    .sticky-product-bar {
      @apply flex flex-wrap flex-col gap-2.5 sm:gap-4 fixed z-[2] bottom-0 left-0 p-3 w-full 
             justify-between items-center shadow-[-1px_-2px_9px_0_rgba(0,0,0,0.05)] 
             transition duration-700 delay-500 translate-y-100 opacity-0 ease-elastic;

      &__quantity,
      salla-add-product-button {
        @apply translate-y-5 opacity-0 transition duration-700 ease-elastic w-full;
      }

      &__price,
      .form-label {
        @apply hidden;
      }

      &__quantity {
        salla-quantity-input {
          @apply w-full;
          .s-quantity-input-container {
            @apply w-full;
          }
          .s-quantity-input-input {
            @apply w-[80%];
          }
        }
        @apply m-0 delay-[900ms];
      }

      salla-add-product-button {
        @apply w-auto m-0 flex-1 delay-1000;
      }

      .hydrated & {
        &,
        &__quantity,
        salla-add-product-button {
          @apply translate-y-0 opacity-100;
        }
      }
    }
  }
}

// تنسيقات إضافية
.s-product {
  &-card {
    &-content-sub {
      @apply justify-start gap-3;
    }

    &-starting-price {
      @apply w-auto;
    }

    &-sale-price {
      h4 {
        @apply text-red-800 #{!important};
      }

      span {
        @apply text-inherit;
      }
    }
  }
}

// تنسيقات صفحة المنتج
.product {
  &-entry {
    @apply h-full transition-shadow duration-300 bg-white hover:shadow-default rounded-lg;

    // صورة المنتج
    &__image {
      @apply relative overflow-hidden rounded-t-lg;
      aspect-ratio: 1;

      img {
        @apply object-cover w-full h-full transition-transform duration-300;
      }

      &:hover img {
        @apply scale-110;
      }
    }

    // شارة الخصم
    .discount-badge {
      @apply absolute top-2 rtl:left-2 ltr:right-2 bg-red-100 text-red-800 
             text-xs px-2 py-1 rounded z-10;
    }
  }

  // معلومات السعر
  &-price {
    &-wrapper {
      @apply flex items-center gap-4 flex-wrap mb-6;
    }

    &-sale {
      @apply text-red-800 font-bold text-xl;
    }

    &-regular {
      @apply text-gray-500 line-through text-sm;
    }

    &-starting {
      @apply text-gray-500 text-sm;
    }
  }

  // معلومات المخزون
  &-stock {
    @apply bg-white py-2.5 px-4 mb-5 rounded-md text-sm flex items-center gap-4;

    &-item {
      @apply flex items-center gap-2;

      i {
        @apply text-red-800;
      }

      &:not(:last-child) {
        @apply rtl:border-l ltr:border-r border-gray-200 rtl:pl-4 ltr:pr-4;
      }
    }

    &-limited {
      @apply text-red-600 text-xs mt-1;
    }
  }

  // خيارات المنتج
  &-options {
    @apply space-y-4 mb-6;

    &-title {
      @apply text-sm font-medium mb-2;
    }

    &-colors {
      @apply flex flex-wrap gap-3;

      .color-option {
        @apply relative;

        input {
          @apply hidden;

          &:checked + span {
            @apply ring-2 ring-primary ring-offset-2;
          }
        }

        span {
          @apply block w-8 h-8 rounded-full cursor-pointer 
                 transition-all duration-200;
        }
      }
    }

    select {
      @apply w-full rounded-lg border-gray-200 px-4 py-2.5
             focus:ring-primary focus:border-primary;
    }
  }

  // شريط الشراء الثابت
  &-sticky-bar {
    @apply bg-white p-5 rounded-md shadow-sm;

    &__quantity {
      @apply flex items-center justify-between mb-5;

      .quantity-input {
        @apply w-32;
      }
    }

    &__btn {
      @apply w-full mt-5;
    }

    @screen sm {
      @apply flex items-center gap-4;

      &__quantity {
        @apply mb-0 flex-1;
      }

      &__btn {
        @apply mt-0 flex-1;
      }
    }
  }

  // تكبير الصورة
  &-zoom {
    .magnify-wrapper {
      @apply relative overflow-hidden;

      .img-magnifier-glass {
        @apply hidden sm:block absolute z-[3] rounded-full cursor-none
               w-[300px] h-[300px] opacity-0 pointer-events-none scale-0
               transition-transform duration-500 ease-out
               shadow-[inset_0px_0px_30px_#949494];

        &:hover {
          @apply opacity-100 pointer-events-auto scale-100 delay-300;
        }
      }
    }
  }

  // التقييمات
  &-rating {
    @apply flex items-center gap-2 mb-4;

    &-stars {
      @apply text-yellow-400;
    }

    &-count {
      @apply text-sm text-gray-500;
    }
  }

  &-details {
    @apply max-w-7xl mx-auto;
  }

  &-gallery {
    @apply relative bg-white rounded-lg overflow-hidden;

    .product-slider {
      @apply relative;

      .swiper-slide {
        @apply aspect-square;
      }
    }

    // تنسيق المصغرات
    .product-thumbs {
      @apply absolute bottom-0 left-0 right-0 z-10
             p-3 bg-white/80 backdrop-blur-sm;

      .swiper-wrapper {
        @apply flex justify-center gap-2;
      }

      .thumb-item {
        @apply w-16 h-16 rounded overflow-hidden cursor-pointer
               border-2 border-transparent transition-all;

        &.swiper-slide-thumb-active {
          @apply border-primary;
        }

        img {
          @apply w-full h-full object-cover;
        }
      }
    }
  }

  // تنسيقات التبويبات
  &-tabs {
    @apply mb-8;

    .tabs-header {
      @apply flex items-center overflow-x-auto;
      
      &::-webkit-scrollbar {
        display: none;
      }
      -ms-overflow-style: none;
      scrollbar-width: none;

      .tab-trigger {
        @apply relative py-3 px-8 text-sm text-gray-500 whitespace-nowrap
               hover:text-gray-900 transition-colors bg-gray-50
               first:rounded-r-lg last:rounded-l-lg;

        &[aria-selected="true"] {
          @apply text-primary bg-primary/5 font-bold;
        }

        // إزالة الخط السفلي
        &:after {
          display: none;
        }
      }
    }
  }

  &-purchase-details {
    @apply sticky top-24;
  }

  &-description {
    @apply text-gray-600 leading-relaxed;
    
    h1, h2, h3, h4, h5, h6 {
      @apply font-bold mb-2;
    }
    
    ul, ol {
      @apply list-inside mb-4;
    }
    
    ul {
      @apply list-disc;
    }
    
    ol {
      @apply list-decimal;
    }
  }

  .brand-logo {
    img {
      @apply max-h-12 w-auto;
    }
  }

  .quantity-wrapper {
    salla-quantity-input {
      @apply bg-white border border-gray-200 rounded-lg;
    }
  }

  salla-add-product-button {
    @apply rounded-lg text-white font-medium text-center
           bg-primary hover:opacity-90 transition-all;
    
    &::part(button) {
      @apply w-full h-full flex items-center justify-center;
    }
  }

  &-meta {
    @apply text-sm;
  }

  &-rating {
    salla-rating-stars {
      @apply flex items-center gap-2;
      
      &::part(stars) {
        @apply text-yellow-400;
      }
    }
  }

  .stock-info {
    i {
      @apply inline-block rtl:ml-2 ltr:mr-2;
    }
  }
}

// تحسينات للموبايل
@media (max-width: 768px) {
  .product-details {
    @apply flex-col;
    
    > div {
      @apply w-full;
    }
  }

  .product-purchase-details {
    @apply static;
  }

  .product-tabs {
    salla-tabs {
      [slot="tabs"] {
        @apply overflow-x-auto;

        .tab-trigger {
          @apply whitespace-nowrap;
        }
      }
    }
  }
}